<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <title>í–‰ìš´ìˆ˜ì§‘ê¸° - ë¡œë˜ ë²ˆí˜¸ ì¶”ì²¨ ê²Œì„</title>
    <style>
        * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
        html,body { height:100%; }
        body{
            min-height:100vh;
            display:flex;
            align-items:flex-start;
            justify-content:center;
            background: linear-gradient(135deg,#667eea 0%,#764ba2 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color:#fff;
            padding:12px;
        }
        .app {
            width:100%;
            max-width:980px;
        }
        .header {
            display:flex;
            align-items:center;
            justify-content:space-between;
            gap:10px;
            margin-bottom:10px;
        }
        h1{
            font-size:clamp(18px,4vw,26px);
            margin:0;
            display:flex;
            align-items:center;
            gap:8px;
        }
        .controls-top {
            display:flex;
            gap:8px;
            align-items:center;
        }
        #volumeBtn{
            background:rgba(255,255,255,0.08);
            color:white;
            border:1px solid rgba(255,255,255,0.12);
            padding:8px 12px;
            border-radius:8px;
            cursor:pointer;
            font-weight:600;
            display:inline-flex;
            align-items:center;
            gap:8px;
        }
        #volumeBtn:active{ transform:scale(0.98); }
        .container {
            background: rgba(255,255,255,0.08);
            backdrop-filter: blur(8px);
            padding:12px;
            border-radius:16px;
            box-shadow:0 8px 30px rgba(0,0,0,0.3);
        }

        #canvasWrapper {
            width:100%;
            margin:0 auto;
            display:flex;
            align-items:center;
            justify-content:center;
        }

        canvas{
            display:block;
            width:100%;
            height:auto;
            border-radius:10px;
            border:3px solid rgba(255,255,255,0.12);
            background:#121224;
            touch-action:none;
        }

        .mobile-hint{
            display:none;
            margin-top:8px;
            font-size:13px;
            text-align:center;
            opacity:0.95;
            background: rgba(255,215,0,0.12);
            color:#111;
            padding:8px;
            border-radius:8px;
        }

        .compact {
            display:flex;
            gap:8px;
            align-items:center;
            justify-content:center;
            margin-top:12px;
        }

        .share-section{
            margin-top:12px;
            padding:10px;
            border-radius:10px;
            background: rgba(255,255,255,0.03);
            display:flex;
            flex-direction:column;
            gap:8px;
            align-items:center;
        }

        .lucky-numbers{
            font-size:clamp(14px,3.5vw,18px);
            color:#FFD700;
            font-weight:700;
            text-align:center;
        }

        .share-buttons{
            display:flex;
            gap:8px;
            flex-wrap:wrap;
            justify-content:center;
        }

        .share-btn{
            padding:8px 12px;
            border-radius:8px;
            border:none;
            cursor:pointer;
            font-weight:700;
        }

        .share-btn.kakao{ background:#FEE500; color:#000; }
        .share-btn.twitter{ background:#1DA1F2; color:#fff; }
        .share-btn.facebook{ background:#1877F2; color:#fff; }
        .share-btn.copy{ background:rgba(255,255,255,0.12); color:#fff; }

        .info{
            margin-top:12px;
            padding:10px;
            border-radius:10px;
            background: rgba(0,0,0,0.12);
            color:rgba(255,255,255,0.75);
            font-size:13px;
            text-align:center;
        }

        /* ëª¨ë°”ì¼ì—ì„œ ìº”ë²„ìŠ¤ ìµœëŒ€í™” & ê´‘ê³ /ë§í¬ ì¶•ì†Œ */
        @media (max-width:768px){
            body{ padding:6px; }
            .app{ padding:4px; }
            .info{ display:none; } /* ê´‘ê³  ì˜ì—­ ìˆ¨ê¹€ */
            .donation{ display:none; }
            .mobile-hint{ display:block; }
            .share-section{ padding:8px; font-size:13px; }
            h1{ font-size:18px; }
            #volumeBtn{ padding:8px; font-size:13px; }
            /* ìº”ë²„ìŠ¤ê°€ í™”ë©´ì—ì„œ í¬ê²Œ ë³´ì´ë„ë¡ ì—¬ë°± ìµœì†Œí™” */
            .container{ padding:8px; border-radius:10px; }
        }
    </style>
</head>
<body>
    <div class="app">
        <div class="header">
            <h1>ğŸ® í–‰ìš´ìˆ˜ì§‘ê¸°</h1>
            <div class="controls-top">
                <button id="volumeBtn" aria-pressed="false">ğŸ”Š ë³¼ë¥¨ ON</button>
            </div>
        </div>

        <div class="container">
            <div id="canvasWrapper">
                <!-- ìº”ë²„ìŠ¤ì˜ width/height ì†ì„±ì€ ì´ˆê¸° ë…¼ë¦¬ í•´ìƒë„ -->
                <canvas id="gameCanvas" width="600" height="400"></canvas>
            </div>

            <div class="mobile-hint">ğŸ“± í™”ë©´ì„ í„°ì¹˜í•˜ë©´ ìš°ì‚°ì´ ê·¸ê³³ìœ¼ë¡œ ì´ë™í•´ìš”!</div>

            <div class="share-section" id="shareSection">
                <div class="lucky-numbers" id="luckyNumbers">ë²ˆí˜¸ 6ê°œë¥¼ ëª¨ë‘ ëª¨ì•„ì£¼ì„¸ìš”!</div>
                <div class="share-buttons">
                    <button class="share-btn kakao" onclick="shareGeneric('kakao')">ğŸ’¬ ì¹´ì¹´ì˜¤í†¡</button>
                    <button class="share-btn twitter" onclick="shareGeneric('twitter')">ğŸ¦ íŠ¸ìœ„í„°</button>
                    <button class="share-btn facebook" onclick="shareGeneric('facebook')">ğŸ“˜ í˜ì´ìŠ¤ë¶</button>
                    <button class="share-btn copy" onclick="generateAndCopyShareLink()">ğŸ”— ë§í¬ ìƒì„± ë° ë³µì‚¬</button>
                </div>
                <div style="font-size:12px; color:rgba(255,255,255,0.6); margin-top:6px;">(ê³µìœ  ë§í¬ë¥¼ ì—´ë©´ ë™ì¼í•œ ë²ˆí˜¸ê°€ ìë™ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤.)</div>
            </div>

            <div class="info" id="adInfo">
                ğŸ“¢ ê´‘ê³  ì˜ì—­ â€” ëª¨ë°”ì¼ì—ì„œëŠ” ì¶•ì†Œ/ìˆ¨ê¹€ ì²˜ë¦¬ë©ë‹ˆë‹¤.
            </div>
        </div>
    </div>

    <script>
    // ------------- ì „ì—­ ì„¤ì • (ë³¼ë¥¨ 30% ê°ì†Œ ì ìš©) -------------
    let globalVolume = 0.7; // "30% ì¤„ì—¬ì¤˜" => ì›ë˜ 1.0 ëŒ€ë¹„ 0.7
    let muted = false;

    const volumeBtn = document.getElementById('volumeBtn');
    volumeBtn.addEventListener('click', () => {
        muted = !muted;
        volumeBtn.textContent = muted ? 'ğŸ”‡ ë³¼ë¥¨ OFF' : 'ğŸ”Š ë³¼ë¥¨ ON';
        volumeBtn.setAttribute('aria-pressed', muted ? 'true':'false');
    });

    // ------------- ìº”ë²„ìŠ¤ & ì‚¬ì´ì¦ˆ ìµœì í™” -------------
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    function resizeCanvas(){
        const wrapper = document.getElementById('canvasWrapper');
        const maxWidth = wrapper.clientWidth;
        const vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);

        // ê¸°ë³¸ ì¢…íš¡ë¹„ (height / width)
        const aspect = 400 / 600;

        // ëª¨ë°”ì¼ì—ì„œ ê°€ëŠ¥í•œ ë†’ì´ë¥¼ ìµœëŒ€ í™œìš© (í—¤ë”/íŒ¨ë”© ê³ ë ¤)
        const smallScreen = vw <= 768;
        let desiredWidth = maxWidth;
        let desiredHeight = Math.round(desiredWidth * aspect);

        if (smallScreen) {
            // í™”ë©´ ì„¸ë¡œ ì¤‘ ìº”ë²„ìŠ¤ì— í• ë‹¹í•  ìµœëŒ€ ë†’ì´: ì „ì²´ ì°½ ë†’ì´ì—ì„œ ì•½ê°„ì˜ UI(í—¤ë”/ë²„íŠ¼) ê³µê°„ì„ ëº€ ê°’
            const reserved = 180; // header + ê¸°íƒ€ UI ì—¬ìœ 
            const availHeight = Math.max(120, window.innerHeight - reserved);
            // ì›í•˜ëŠ” ë†’ì´ëŠ” availHeightë¥¼ ë„˜ì§€ ì•Šë„ë¡
            if (availHeight < desiredHeight) {
                desiredHeight = availHeight;
                desiredWidth = Math.round(desiredHeight / aspect);
            }
        }

        // style í¬ê¸°(ë³´ì´ëŠ” í¬ê¸°)
        canvas.style.width = desiredWidth + 'px';
        canvas.style.height = desiredHeight + 'px';

        // ë…¼ë¦¬ ìº”ë²„ìŠ¤ í•´ìƒë„ë¥¼ ë³´ì´ëŠ” í¬ê¸°ì™€ ê°™ê²Œ ì„¤ì •í•˜ì—¬ ë¬¼ë¦¬ ì¢Œí‘œ ê³„ì‚°ì´ ì¼ê´€ë˜ê²Œ ë™ì‘í•˜ë„ë¡ í•¨
        canvas.width = desiredWidth;
        canvas.height = desiredHeight;

        // ìŠ¬ë¡¯ ë“± í™”ë©´ ìš”ì†Œ ì¬ê³„ì‚°
        rebuildSlots();
    }

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    // ------------- ê²Œì„ ë°ì´í„° (slotsëŠ” resizeì—ì„œ ì¬ìƒì„±) -------------
    const usedNumbers = new Set();
    const player = {
        x: 300, y: 200, width: 60, height: 45, speed: 5,
        hookX: 0, hookY: 0, hookRadius: 25, heldBall: null, caughtBalls: [], maxBalls: 6
    };
    let slots = [];
    let slotSize = 13;

    function rebuildSlots(){
        slots = [];
        slotSize = Math.max(10, Math.round(canvas.width * 0.02));
        const slotStartX = Math.round(canvas.width * 0.05);
        const slotStartY = Math.round(canvas.height * 0.06);
        const slotSpacing = Math.round((canvas.width - slotStartX*2) / 6);
        for (let i=0;i<6;i++){
            slots.push({
                x: slotStartX + i * slotSpacing + Math.round(slotSpacing/2),
                y: slotStartY,
                radius: slotSize + 5,
                filled:false
            });
        }

        // ë§Œì•½ ê³µìœ  URLë¡œ ë²ˆí˜¸ê°€ ë“¤ì–´ì™”ì„ ê²½ìš°, applySharedNumbersì—ì„œ ìŠ¬ë¡¯ì„ ì±„ì›€.
        // ìŠ¬ë¡¯ ìœ„ì¹˜ëŠ” ì´ì œ ì¤€ë¹„ë˜ì—ˆìœ¼ë‹ˆ caughtBallsì˜ slotIndexë¥¼ ê°±ì‹ 
        for (let i=0;i<player.caughtBalls.length;i++){
            player.caughtBalls[i].slotIndex = i;
            player.caughtBalls[i].inSlot = true;
            slots[i].filled = true;
        }
    }

    // ------------- ê³µ, ë¬¼ë¦¬, ìŠ¤í° -------------
    const balls = [];
    const ballRadius = 10;
    const gravity = 0.5;
    const bounce = 0.6;
    let isSpawning = true;
    let cooldownTimer = 0;
    const debris = [];
    const bombZone = { x: 0, y: 10, size: 60, pulseSiz
